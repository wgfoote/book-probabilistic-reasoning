<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Tibbling our way to success | Probabilistic Reasoning</title>
  <meta name="description" content="We explore practical implementations of probabilistic reasoning applied to several domains, especially those in human organizations." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Tibbling our way to success | Probabilistic Reasoning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="We explore practical implementations of probabilistic reasoning applied to several domains, especially those in human organizations." />
  <meta name="github-repo" content="wgfoote/book-probabilistic-reasoning" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Tibbling our way to success | Probabilistic Reasoning" />
  <meta name="twitter:site" content="@wgfoote" />
  <meta name="twitter:description" content="We explore practical implementations of probabilistic reasoning applied to several domains, especially those in human organizations." />
  

<meta name="author" content="William G. Foote" />


<meta name="date" content="2020-09-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tickling-the-ivories.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Probabilistic Reasoning: A Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#premises"><i class="fa fa-check"></i>Premises</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dont-we-know-everything-we-need-to-know"><i class="fa fa-check"></i>Don’t we know everything we need to know?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-we-desire"><i class="fa fa-check"></i>What we desire</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why this book?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-background.html"><a href="part-i-background.html"><i class="fa fa-check"></i>Part I. Background</a></li>
<li class="chapter" data-level="1" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html"><i class="fa fa-check"></i><b>1</b> Plausibility, Probability and Information</a><ul>
<li class="chapter" data-level="1.1" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#some-surprise"><i class="fa fa-check"></i><b>1.1</b> Some Surprise</a></li>
<li class="chapter" data-level="1.2" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#informative"><i class="fa fa-check"></i><b>1.2</b> Informative?</a></li>
<li class="chapter" data-level="1.3" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#we-have-a-proposition-for-you"><i class="fa fa-check"></i><b>1.3</b> We have a proposition for you</a></li>
<li class="chapter" data-level="1.4" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#the-power-of-plausible-thinking"><i class="fa fa-check"></i><b>1.4</b> The power of plausible thinking</a></li>
<li class="chapter" data-level="1.5" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#how-many-ways"><i class="fa fa-check"></i><b>1.5</b> How many ways?</a></li>
<li class="chapter" data-level="1.6" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#how-informative"><i class="fa fa-check"></i><b>1.6</b> How informative?</a></li>
<li class="chapter" data-level="1.7" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#nota-bene"><i class="fa fa-check"></i><b>1.7</b> Nota Bene</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html"><i class="fa fa-check"></i><b>2</b> Probability for Real People</a><ul>
<li class="chapter" data-level="2.1" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#can-we-rationally-reason"><i class="fa fa-check"></i><b>2.1</b> Can we rationally reason?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#priors-what-we-think-can-happen"><i class="fa fa-check"></i><b>2.1.1</b> Priors: what we think can happen</a></li>
<li class="chapter" data-level="2.1.2" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#likelihoods-thinking-about-the-data"><i class="fa fa-check"></i><b>2.1.2</b> Likelihoods: thinking about the data</a></li>
<li class="chapter" data-level="2.1.3" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#altogether-now"><i class="fa fa-check"></i><b>2.1.3</b> Altogether now</a></li>
<li class="chapter" data-level="2.1.4" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#updating-beliefs"><i class="fa fa-check"></i><b>2.1.4</b> Updating beliefs</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#whats-next"><i class="fa fa-check"></i><b>2.2</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-using-r.html"><a href="part-ii-using-r.html"><i class="fa fa-check"></i>Part II. Using R</a></li>
<li class="chapter" data-level="3" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html"><i class="fa fa-check"></i><b>3</b> Warming up to R</a><ul>
<li class="chapter" data-level="3.1" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#imagine-this"><i class="fa fa-check"></i><b>3.1</b> Imagine This</a><ul>
<li class="chapter" data-level="3.1.1" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#modeling-process"><i class="fa fa-check"></i><b>3.1.1</b> Modeling process</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#chapter-overview"><i class="fa fa-check"></i><b>3.2</b> Chapter overview</a></li>
<li class="chapter" data-level="3.3" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#what-is-r"><i class="fa fa-check"></i><b>3.3</b> What is <code>R</code>?</a></li>
<li class="chapter" data-level="3.4" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#r-for-analytics"><i class="fa fa-check"></i><b>3.4</b> <code>R</code> for analytics</a></li>
<li class="chapter" data-level="3.5" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#hot-and-cold-running-resources"><i class="fa fa-check"></i><b>3.5</b> Hot and cold running resources</a></li>
<li class="chapter" data-level="3.6" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#gettingR"><i class="fa fa-check"></i><b>3.6</b> Installing R</a><ul>
<li class="chapter" data-level="3.6.1" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#installing-r-on-a-windows-computer"><i class="fa fa-check"></i><b>3.6.1</b> Installing R on a Windows computer</a></li>
<li class="chapter" data-level="3.6.2" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#installing-r-on-a-mac"><i class="fa fa-check"></i><b>3.6.2</b> Installing R on a Mac</a></li>
<li class="chapter" data-level="3.6.3" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#installing-r-on-a-linux-computer"><i class="fa fa-check"></i><b>3.6.3</b> Installing R on a Linux computer</a></li>
<li class="chapter" data-level="3.6.4" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#installingrstudio"><i class="fa fa-check"></i><b>3.6.4</b> Downloading and installing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#first-day-at-school"><i class="fa fa-check"></i><b>3.7</b> First day at school</a><ul>
<li class="chapter" data-level="3.7.1" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#install-r-markdown"><i class="fa fa-check"></i><b>3.7.1</b> Install <code>R Markdown</code></a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#install-latex"><i class="fa fa-check"></i><b>3.8</b> Install LaTex</a><ul>
<li class="chapter" data-level="3.8.1" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#our-first-file"><i class="fa fa-check"></i><b>3.8.1</b> Our first file</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="warming-up-to-r.html"><a href="warming-up-to-r.html#jargon"><i class="fa fa-check"></i><b>3.9</b> jaRgon</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html"><i class="fa fa-check"></i><b>4</b> Tickling the Ivories</a><ul>
<li class="chapter" data-level="4.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#start-to-tickle"><i class="fa fa-check"></i><b>4.1</b> Start to tickle</a></li>
<li class="chapter" data-level="4.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#try-this-exercise"><i class="fa fa-check"></i><b>4.2</b> Try this exercise</a></li>
<li class="chapter" data-level="4.3" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#building-some-character"><i class="fa fa-check"></i><b>4.3</b> Building Some Character</a></li>
<li class="chapter" data-level="4.4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#the-plot-thickens"><i class="fa fa-check"></i><b>4.4</b> The plot thickens</a><ul>
<li class="chapter" data-level="4.4.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#try-this-example"><i class="fa fa-check"></i><b>4.4.1</b> Try this example</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#arrays-and-you"><i class="fa fa-check"></i><b>4.5</b> Arrays and You</a><ul>
<li class="chapter" data-level="4.5.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#try-this-exercise-1"><i class="fa fa-check"></i><b>4.5.1</b> Try this exercise</a></li>
<li class="chapter" data-level="4.5.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#more-about-residuals"><i class="fa fa-check"></i><b>4.5.2</b> More about residuals</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#more-array-work"><i class="fa fa-check"></i><b>4.6</b> More Array Work</a></li>
<li class="chapter" data-level="4.7" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#summary"><i class="fa fa-check"></i><b>4.7</b> Summary</a></li>
<li class="chapter" data-level="4.8" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#further-reading"><i class="fa fa-check"></i><b>4.8</b> Further Reading</a></li>
<li class="chapter" data-level="4.9" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#practice-sets"><i class="fa fa-check"></i><b>4.9</b> Practice Sets</a><ul>
<li class="chapter" data-level="4.9.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#purpose-process-product"><i class="fa fa-check"></i><b>4.9.1</b> Purpose, Process, Product</a></li>
<li class="chapter" data-level="4.9.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#r-markdown-set-up"><i class="fa fa-check"></i><b>4.9.2</b> <code>R Markdown</code> set up</a></li>
<li class="chapter" data-level="4.9.3" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#mutual-fund-simulation"><i class="fa fa-check"></i><b>4.9.3</b> Mutual Fund simulation</a></li>
<li class="chapter" data-level="4.9.4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#healthcare-provider-admission-rates"><i class="fa fa-check"></i><b>4.9.4</b> Healthcare provider admission rates</a></li>
<li class="chapter" data-level="4.9.5" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#practice-set-debrief"><i class="fa fa-check"></i><b>4.9.5</b> Practice Set Debrief</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#project-captive-financing"><i class="fa fa-check"></i><b>4.10</b> Project: Captive Financing</a><ul>
<li class="chapter" data-level="4.10.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#purpose"><i class="fa fa-check"></i><b>4.10.1</b> Purpose</a></li>
<li class="chapter" data-level="4.10.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#problem-2"><i class="fa fa-check"></i><b>4.10.2</b> Problem</a></li>
<li class="chapter" data-level="4.10.3" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#data"><i class="fa fa-check"></i><b>4.10.3</b> Data</a></li>
<li class="chapter" data-level="4.10.4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#work-flow"><i class="fa fa-check"></i><b>4.10.4</b> Work Flow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tibbling-our-way-to-success.html"><a href="tibbling-our-way-to-success.html"><i class="fa fa-check"></i><b>5</b> Tibbling our way to success</a><ul>
<li class="chapter" data-level="5.1" data-path="tibbling-our-way-to-success.html"><a href="tibbling-our-way-to-success.html#counting-possibilities."><i class="fa fa-check"></i><b>5.1</b> Counting possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probabilistic Reasoning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tibbling-our-way-to-success" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Tibbling our way to success</h1>
<div id="counting-possibilities." class="section level2">
<h2><span class="header-section-number">5.1</span> Counting possibilities.</h2>
<p>Instead of the base R wrangling we began to use in the previous chapter, we’ll make extensive use of the many packages from the <a href="https://www.tidyverse.org"><strong>tidyverse</strong></a> for data wrangling and plotting.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>If you are new to <strong>tidyverse</strong>-style syntax, possibly the oddest component is the pipe (i.e., <code>%&gt;%</code>). I’m not going to explain the <code>%&gt;%</code> in this project, but you might learn more about in <a href="https://www.youtube.com/watch?v=9yjhxvu-pDg">this brief clip</a>, starting around <a href="https://www.youtube.com/watch?v=K-ss_ag2k9E&amp;t=1285s">minute 21:25 in this talk by Wickham</a>, or in <a href="https://r4ds.had.co.nz/transform.html#combining-multiple-operations-with-the-pipe">Section 5.6.1</a> from Grolemund and Wickham’s <span class="citation">(<span class="citeproc-not-found" data-reference-id="grolemundDataScience2017"><strong>???</strong></span>)</span> <em>R for data science</em>. Really, all of Chapter 5 of <em>R4DS</em> is just great for new <strong>R</strong> and new <strong>tidyverse</strong> users. And <em>R4DS</em> Chapter 3 is a nice introduction to plotting with <strong>ggplot2</strong> <span class="citation">(Wickham et al. <a href="#ref-R-ggplot2" role="doc-biblioref">2020</a>; <span class="citeproc-not-found" data-reference-id="wickhamGgplot2ElegantGraphics2016"><strong>???</strong></span>)</span>.</p>
<p>Other than the pipe, the other big thing to be aware of is <a href="https://tibble.tidyverse.org">tibbles</a> <span class="citation">(Müller and Wickham <a href="#ref-R-tibble" role="doc-biblioref">2020</a>)</span>. For our purposes, think of a tibble as a data object with two dimensions defined by rows and columns. Importantly, tibbles are just special types of <a href="https://bookdown.org/rdpeng/rprogdatascience/r-nuts-and-bolts.html#data-framesbookdown::preview_chapter(%2206.Rmd%22)">data frames</a>. So, whenever we talk about data frames, we’re usually talking about tibbles. For more on the topic, check out <a href="https://r4ds.had.co.nz/tibbles.html"><em>R4SD</em>, Chapter 10</a>.</p>
<p>If we’re willing to code the marbles as 0 = “white” 1 = “blue”, we can arrange the possibility data in a tibble as follows.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">p1 =</span> <span class="dv">0</span>, <span class="dt">p2 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb125-2" title="2">    <span class="dv">3</span>)), <span class="dt">p3 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb125-3" title="3">    <span class="dt">p4 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)), <span class="dt">p5 =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb125-4" title="4"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 5
##      p1    p2    p3    p4    p5
##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     0     1     1     1     1
## 2     0     0     1     1     1
## 3     0     0     0     1     1
## 4     0     0     0     0     1</code></pre>
<p>You might depict the possibility data in a plot.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb127-2" title="2"><span class="st">    </span><span class="kw">pivot_longer</span>(<span class="op">-</span>x, <span class="dt">names_to =</span> <span class="st">&quot;possibility&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb127-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">value =</span> value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="st">    </span></a>
<a class="sourceLine" id="cb127-5" title="5"><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> possibility, <span class="dt">fill =</span> value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb127-6" title="6"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb127-7" title="7"><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb127-8" title="8">        <span class="st">&quot;navy&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb127-9" title="9">    <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-74-1.png" width="120" /></p>
<p>As a quick aside, check out Suzan Baert’s blog post <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-2/"><em>Data wrangling part 2: Transforming your columns into the right shape</em></a> for an extensive discussion on <code>dplyr::mutate()</code> and <code>tidyr::gather()</code>. The <code>tidyr::pivot_longer()</code> function is an updated variant of <code>gather()</code>, which we’ll be making extensive use of throughout this project. If you’re new to reshaping data with pivoting, check out the vignettes <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">here</a> and <a href="https://tidyr.tidyverse.org/articles/pivot.html">here</a> <span class="citation">(<span class="citeproc-not-found" data-reference-id="PivotDataWide2020"><strong>???</strong></span>; <span class="citeproc-not-found" data-reference-id="Pivoting2020"><strong>???</strong></span>)</span>.</p>
<p>Here’s the basic structure of the possibilities per marble draw.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">tibble</span>(<span class="dt">draw =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">marbles =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">possibilities =</span> marbles<span class="op">^</span>draw) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb128-2" title="2"><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
draw
</th>
<th style="text-align:right;">
marbles
</th>
<th style="text-align:right;">
possibilities
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
16
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
64
</td>
</tr>
</tbody>
</table>
<p>If you walk that out a little, you can structure the data required to approach Figure 2.2.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">(d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">position =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb129-2" title="2">    (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>), <span class="dt">draw =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb129-3" title="3">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)), <span class="dt">fill =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, </a>
<a class="sourceLine" id="cb129-4" title="4">    <span class="st">&quot;w&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., </a>
<a class="sourceLine" id="cb129-5" title="5">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<pre><code>## # A tibble: 84 x 3
##    position  draw fill 
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;
##  1     1        1 b    
##  2     2        1 w    
##  3     3        1 w    
##  4     4        1 w    
##  5     0.25     2 b    
##  6     0.5      2 w    
##  7     0.75     2 w    
##  8     1        2 w    
##  9     1.25     2 b    
## 10     1.5      2 w    
## # ... with 74 more rows</code></pre>
<p>See what I did there with the parentheses? If you assign a value to an object in <strong>R</strong> (e.g., <code>dog &lt;- 1</code>) and just hit return, nothing will immediately pop up in the <a href="http://r4ds.had.co.nz/introduction.html#rstudio">console</a>. You have to actually execute <code>dog</code> before <strong>R</strong> will return <code>1</code>. But if you wrap the code within parentheses (e.g., <code>(dog &lt;- 1)</code>), <strong>R</strong> will perform the assignment and return the value as if you had executed <code>dog</code>.</p>
<p>But we digress. Here’s the initial plot.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw, </a>
<a class="sourceLine" id="cb131-2" title="2">    <span class="dt">fill =</span> fill)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </a>
<a class="sourceLine" id="cb131-3" title="3">    <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, </a>
<a class="sourceLine" id="cb131-4" title="4">    <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-5" title="5"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-77-1.png" width="768" /></p>
<p>To my mind, the easiest way to connect the dots in the appropriate way is to make two auxiliary tibbles.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="co"># these will connect the dots from</span></a>
<a class="sourceLine" id="cb132-2" title="2"><span class="co"># the first and second draws</span></a>
<a class="sourceLine" id="cb132-3" title="3">(lines_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb132-4" title="4">    <span class="dt">xend =</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>), <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">yend =</span> <span class="dv">2</span>))</a></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1  0.25     1     2
##  2     1  0.5      1     2
##  3     1  0.75     1     2
##  4     1  1        1     2
##  5     2  1.25     1     2
##  6     2  1.5      1     2
##  7     2  1.75     1     2
##  8     2  2        1     2
##  9     3  2.25     1     2
## 10     3  2.5      1     2
## 11     3  2.75     1     2
## 12     3  3        1     2
## 13     4  3.25     1     2
## 14     4  3.5      1     2
## 15     4  3.75     1     2
## 16     4  4        1     2</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co"># these will connect the dots from</span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="co"># the second and third draws</span></a>
<a class="sourceLine" id="cb134-3" title="3">(lines_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rep</span>(((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>), </a>
<a class="sourceLine" id="cb134-4" title="4">    <span class="dt">each =</span> <span class="dv">4</span>), <span class="dt">xend =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">2</span>), </a>
<a class="sourceLine" id="cb134-5" title="5">    <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">yend =</span> <span class="dv">3</span>))</a></code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.25 0.0625     2     3
##  2  0.25 0.125      2     3
##  3  0.25 0.188      2     3
##  4  0.25 0.25       2     3
##  5  0.5  0.312      2     3
##  6  0.5  0.375      2     3
##  7  0.5  0.438      2     3
##  8  0.5  0.5        2     3
##  9  0.75 0.562      2     3
## 10  0.75 0.625      2     3
## # ... with 54 more rows</code></pre>
<p>We can use the <code>lines_1</code> and <code>lines_2</code> data in the plot with two <code>geom_segment()</code> functions.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-2" title="2"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb136-3" title="3">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb136-4" title="4">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb136-5" title="5">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb136-6" title="6">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill), </a>
<a class="sourceLine" id="cb136-7" title="7">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, </a>
<a class="sourceLine" id="cb136-8" title="8">    <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-9" title="9"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-79-1.png" width="768" /></p>
<p>We’ve generated the values for <code>position</code> (i.e., the <span class="math inline">\(x\)</span>-axis), in such a way that they’re all justified to the right, so to speak. But we’d like to center them. For <code>draw == 1</code>, we’ll need to subtract 0.5 from each. For <code>draw == 2</code>, we need to reduce the scale by a factor of 4 and we’ll then need to reduce the scale by another factor of 4 for <code>draw == 3</code>. The <code>ifelse()</code> function will be of use for that.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">d &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">denominator =</span> <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-2" title="2"><span class="st">    </span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span>, </a>
<a class="sourceLine" id="cb137-3" title="3">    <span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">position =</span> position <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb137-4" title="4"><span class="st">    </span>denominator)</a>
<a class="sourceLine" id="cb137-5" title="5">d</a></code></pre></div>
<pre><code>## # A tibble: 84 x 4
##    position  draw fill  denominator
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1    0.5       1 b           0.5  
##  2    1.5       1 w           0.5  
##  3    2.5       1 w           0.5  
##  4    3.5       1 w           0.5  
##  5    0.125     2 b           0.125
##  6    0.375     2 w           0.125
##  7    0.625     2 w           0.125
##  8    0.875     2 w           0.125
##  9    1.12      2 b           0.125
## 10    1.38      2 w           0.125
## # ... with 74 more rows</code></pre>
<p>We’ll follow the same logic for the <code>lines_1</code> and <code>lines_2</code> data.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">(lines_<span class="dv">1</span> &lt;-<span class="st"> </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> x <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-2" title="2"><span class="st">    </span><span class="fl">0.5</span>, <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   0.5 0.125     1     2
##  2   0.5 0.375     1     2
##  3   0.5 0.625     1     2
##  4   0.5 0.875     1     2
##  5   1.5 1.12      1     2
##  6   1.5 1.38      1     2
##  7   1.5 1.62      1     2
##  8   1.5 1.88      1     2
##  9   2.5 2.12      1     2
## 10   2.5 2.38      1     2
## 11   2.5 2.62      1     2
## 12   2.5 2.88      1     2
## 13   3.5 3.12      1     2
## 14   3.5 3.38      1     2
## 15   3.5 3.62      1     2
## 16   3.5 3.88      1     2</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">(lines_<span class="dv">2</span> &lt;-<span class="st"> </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> x <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb141-2" title="2"><span class="st">    </span><span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.125 0.0312     2     3
##  2 0.125 0.0938     2     3
##  3 0.125 0.156      2     3
##  4 0.125 0.219      2     3
##  5 0.375 0.281      2     3
##  6 0.375 0.344      2     3
##  7 0.375 0.406      2     3
##  8 0.375 0.469      2     3
##  9 0.625 0.531      2     3
## 10 0.625 0.594      2     3
## # ... with 54 more rows</code></pre>
<p>Now the plot’s looking closer.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb143-2" title="2"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb143-3" title="3">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb143-4" title="4">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb143-5" title="5">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb143-6" title="6">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill), </a>
<a class="sourceLine" id="cb143-7" title="7">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, </a>
<a class="sourceLine" id="cb143-8" title="8">    <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb143-9" title="9"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-82-1.png" width="768" /></p>
<p>For the final step, we’ll use <code>coord_polar()</code> to change the <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/coord">coordinate system</a>, giving the plot a mandala-like feel.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb144-2" title="2"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb144-3" title="3">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb144-4" title="4">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb144-5" title="5">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb144-6" title="6">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill), </a>
<a class="sourceLine" id="cb144-7" title="7">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, </a>
<a class="sourceLine" id="cb144-8" title="8">    <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb144-9" title="9">    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb144-10" title="10"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, </a>
<a class="sourceLine" id="cb144-11" title="11">        <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_polar</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb144-12" title="12"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-83-1.png" width="384" /></p>
<p>To make our version of Figure 2.3, we’ll have to add an index to tell us which paths remain logically valid after each choice. We’ll call the index <code>remain</code>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">lines_<span class="dv">1</span> &lt;-<span class="st"> </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb145-2" title="2">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb145-3" title="3"><span class="st">    </span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb145-4" title="4">lines_<span class="dv">2</span> &lt;-<span class="st"> </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb145-5" title="5">    <span class="dt">times =</span> <span class="dv">4</span>), <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb145-6" title="6">    <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb145-7" title="7">    <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb145-8" title="8">d &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb145-9" title="9">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)), <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb145-10" title="10">    <span class="dv">3</span>)), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>), <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb145-11" title="11">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb145-12" title="12">    <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb145-13" title="13"><span class="co"># finally, the plot:</span></a>
<a class="sourceLine" id="cb145-14" title="14">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb145-15" title="15"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb145-16" title="16">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend, </a>
<a class="sourceLine" id="cb145-17" title="17">        <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb145-18" title="18">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb145-19" title="19">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend, </a>
<a class="sourceLine" id="cb145-20" title="20">        <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb145-21" title="21">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill, </a>
<a class="sourceLine" id="cb145-22" title="22">    <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb145-23" title="23">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="co"># it&#39;s the alpha parameter that makes</span></a>
<a class="sourceLine" id="cb145-24" title="24"><span class="co"># elements semitransparent</span></a>
<a class="sourceLine" id="cb145-25" title="25"><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, </a>
<a class="sourceLine" id="cb145-26" title="26">    <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb145-27" title="27">    <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb145-28" title="28">    <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb145-29" title="29">    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb145-30" title="30"><span class="st">    </span><span class="kw">coord_polar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb145-31" title="31">    <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-84-1.png" width="384" /></p>
<p>Letting “w” = a white dot and “b” = a blue dot, we might recreate the table in the middle of page 23 like so.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="co"># if we make two custom functions,</span></a>
<a class="sourceLine" id="cb146-2" title="2"><span class="co"># here, it will simplify the code</span></a>
<a class="sourceLine" id="cb146-3" title="3"><span class="co"># within `mutate()`, below</span></a>
<a class="sourceLine" id="cb146-4" title="4">n_blue &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb146-5" title="5">    <span class="kw">rowSums</span>(x <span class="op">==</span><span class="st"> &quot;b&quot;</span>)</a>
<a class="sourceLine" id="cb146-6" title="6">}</a>
<a class="sourceLine" id="cb146-7" title="7">n_white &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb146-8" title="8">    <span class="kw">rowSums</span>(x <span class="op">==</span><span class="st"> &quot;w&quot;</span>)</a>
<a class="sourceLine" id="cb146-9" title="9">}</a>
<a class="sourceLine" id="cb146-10" title="10">t &lt;-<span class="st"> </span><span class="co"># for the first four columns, `p_`</span></a>
<a class="sourceLine" id="cb146-11" title="11"><span class="co"># indexes position</span></a>
<a class="sourceLine" id="cb146-12" title="12"><span class="kw">tibble</span>(<span class="dt">p_1 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb146-13" title="13">    <span class="dv">4</span>)), <span class="dt">p_2 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb146-14" title="14">    <span class="dv">3</span>)), <span class="dt">p_3 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, </a>
<a class="sourceLine" id="cb146-15" title="15">    <span class="dv">2</span>)), <span class="dt">p_4 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span>, </a>
<a class="sourceLine" id="cb146-16" title="16">    <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">draw 1: blue</span><span class="st">`</span> =<span class="st"> </span><span class="kw">n_blue</span>(.), </a>
<a class="sourceLine" id="cb146-17" title="17">    <span class="st">`</span><span class="dt">draw 2: white</span><span class="st">`</span> =<span class="st"> </span><span class="kw">n_white</span>(.), <span class="st">`</span><span class="dt">draw 3: blue</span><span class="st">`</span> =<span class="st"> </span><span class="kw">n_blue</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb146-18" title="18"><span class="st">    </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">ways to produce</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">draw 1: blue</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb146-19" title="19"><span class="st">        `</span><span class="dt">draw 2: white</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">draw 3: blue</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb146-20" title="20">t <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
p_1
</th>
<th style="text-align:left;">
p_2
</th>
<th style="text-align:left;">
p_3
</th>
<th style="text-align:left;">
p_4
</th>
<th style="text-align:right;">
draw 1: blue
</th>
<th style="text-align:right;">
draw 2: white
</th>
<th style="text-align:right;">
draw 3: blue
</th>
<th style="text-align:right;">
ways to produce
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
w
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
w
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:left;">
b
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>We’ll need new data for Figure 2.4. Here’s the initial primary data, <code>d</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">d &lt;-</a>
<a class="sourceLine" id="cb147-2" title="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">position =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb147-3" title="3">                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb147-4" title="4">                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb147-5" title="5">         <span class="dt">draw     =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb147-6" title="6">(</a>
<a class="sourceLine" id="cb147-7" title="7">  d &lt;-</a>
<a class="sourceLine" id="cb147-8" title="8"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-9" title="9"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb147-10" title="10">    d, d</a>
<a class="sourceLine" id="cb147-11" title="11">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-12" title="12"><span class="st">  </span><span class="co"># here are the fill colors</span></a>
<a class="sourceLine" id="cb147-13" title="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb147-14" title="14">                  <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">each  =</span> <span class="dv">2</span>)       <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb147-15" title="15">                  <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-16" title="16"><span class="st">  </span><span class="co"># now we need to shift the positions over in accordance with draw, like before</span></a>
<a class="sourceLine" id="cb147-17" title="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">denominator =</span> <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb147-18" title="18">                              <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb147-19" title="19">                                     <span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-20" title="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position =</span> position <span class="op">-</span><span class="st"> </span>denominator) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-21" title="21"><span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></a>
<a class="sourceLine" id="cb147-22" title="22"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb147-23" title="23"><span class="st">  </span><span class="co"># to get the position axis correct for pie_index == &quot;b&quot; or &quot;c&quot;, we&#39;ll need to offset</span></a>
<a class="sourceLine" id="cb147-24" title="24"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position =</span> <span class="kw">ifelse</span>(pie_index <span class="op">==</span><span class="st"> &quot;a&quot;</span>, position,</a>
<a class="sourceLine" id="cb147-25" title="25">                           <span class="kw">ifelse</span>(pie_index <span class="op">==</span><span class="st"> &quot;b&quot;</span>, position <span class="op">+</span><span class="st"> </span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb147-26" title="26">                                  position <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb147-27" title="27">)</a></code></pre></div>
<pre><code>## # A tibble: 252 x 5
##    position  draw fill  denominator pie_index
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    
##  1    0.5       1 w           0.5   a        
##  2    1.5       1 b           0.5   a        
##  3    2.5       1 b           0.5   a        
##  4    3.5       1 b           0.5   a        
##  5    0.125     2 w           0.125 a        
##  6    0.375     2 b           0.125 a        
##  7    0.625     2 b           0.125 a        
##  8    0.875     2 b           0.125 a        
##  9    1.12      2 w           0.125 a        
## 10    1.38      2 b           0.125 a        
## # ... with 242 more rows</code></pre>
<p>Both <code>lines_1</code> and <code>lines_2</code> require adjustments for <code>x</code> and <code>xend</code>. Our current approach is a nested <code>ifelse()</code>. Rather than copy and paste that multi-line <code>ifelse()</code> code for all four, let’s wrap it in a compact function, which we’ll call <code>move_over()</code>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">move_over &lt;-<span class="st"> </span><span class="cf">function</span>(position, index) {</a>
<a class="sourceLine" id="cb149-2" title="2">    <span class="kw">ifelse</span>(index <span class="op">==</span><span class="st"> &quot;a&quot;</span>, position, <span class="kw">ifelse</span>(index <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb149-3" title="3"><span class="st">        &quot;b&quot;</span>, position <span class="op">+</span><span class="st"> </span><span class="dv">4</span>, position <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb149-4" title="4"><span class="st">        </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb149-5" title="5">}</a></code></pre></div>
<p>If you’re new to making your own <strong>R</strong> functions, check out <a href="http://r4ds.had.co.nz/functions.html">Chapter 19</a> of <em>R4DS</em> or <a href="https://bookdown.org/rdpeng/rprogdatascience/functions.html">Chapter 14</a> of <em>R programming for data science</em> <span class="citation">(<span class="citeproc-not-found" data-reference-id="pengProgrammingDataScience2019"><strong>???</strong></span>)</span>.</p>
<p>Anyway, now we’ll make our new <code>lines_1</code> and <code>lines_2</code> data, for which we’ll use <code>move_over()</code> to adjust their <code>x</code> and <code>xend</code> positions to the correct spots.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">(</a>
<a class="sourceLine" id="cb150-2" title="2">  lines_<span class="dv">1</span> &lt;-</a>
<a class="sourceLine" id="cb150-3" title="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb150-4" title="4">         <span class="dt">xend =</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)        <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb150-5" title="5">         <span class="dt">y    =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb150-6" title="6">         <span class="dt">yend =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span><span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb150-8" title="8">         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-9" title="9"><span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></a>
<a class="sourceLine" id="cb150-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-11" title="11"><span class="st">  </span><span class="co"># to get the position axis correct for `pie_index == &quot;b&quot;` or `&quot;c&quot;`, we&#39;ll need to offset</span></a>
<a class="sourceLine" id="cb150-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> x,    <span class="dt">index =</span> pie_index),</a>
<a class="sourceLine" id="cb150-13" title="13">         <span class="dt">xend =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> xend, <span class="dt">index =</span> pie_index))</a>
<a class="sourceLine" id="cb150-14" title="14">)</a></code></pre></div>
<pre><code>## # A tibble: 48 x 5
##        x  xend     y  yend pie_index
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1   0.5 0.125     1     2 a        
##  2   0.5 0.375     1     2 a        
##  3   0.5 0.625     1     2 a        
##  4   0.5 0.875     1     2 a        
##  5   1.5 1.12      1     2 a        
##  6   1.5 1.38      1     2 a        
##  7   1.5 1.62      1     2 a        
##  8   1.5 1.88      1     2 a        
##  9   2.5 2.12      1     2 a        
## 10   2.5 2.38      1     2 a        
## # ... with 38 more rows</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1">(</a>
<a class="sourceLine" id="cb152-2" title="2">  lines_<span class="dv">2</span> &lt;-</a>
<a class="sourceLine" id="cb152-3" title="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>(((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb152-4" title="4">         <span class="dt">xend =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)                 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb152-5" title="5">         <span class="dt">y    =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb152-6" title="6">         <span class="dt">yend =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-7" title="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb152-8" title="8">         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-9" title="9"><span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></a>
<a class="sourceLine" id="cb152-10" title="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-11" title="11"><span class="st">  </span><span class="co"># to get the position axis correct for `pie_index == &quot;b&quot;` or `&quot;c&quot;`, we&#39;ll need to offset</span></a>
<a class="sourceLine" id="cb152-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> x,    <span class="dt">index =</span> pie_index),</a>
<a class="sourceLine" id="cb152-13" title="13">         <span class="dt">xend =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> xend, <span class="dt">index =</span> pie_index))</a>
<a class="sourceLine" id="cb152-14" title="14">)</a></code></pre></div>
<pre><code>## # A tibble: 192 x 5
##        x   xend     y  yend pie_index
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1 0.125 0.0312     2     3 a        
##  2 0.125 0.0938     2     3 a        
##  3 0.125 0.156      2     3 a        
##  4 0.125 0.219      2     3 a        
##  5 0.375 0.281      2     3 a        
##  6 0.375 0.344      2     3 a        
##  7 0.375 0.406      2     3 a        
##  8 0.375 0.469      2     3 a        
##  9 0.625 0.531      2     3 a        
## 10 0.625 0.594      2     3 a        
## # ... with 182 more rows</code></pre>
<p>For the last data wrangling step, we add the <code>remain</code> indices to help us determine which parts to make semitransparent. I’m not sure of a slick way to do this, so these are the result of brute force counting.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1">d &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb154-2" title="2"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb154-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="co">#pie_index == &quot;a&quot;</span></a>
<a class="sourceLine" id="cb154-4" title="4">                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</a>
<a class="sourceLine" id="cb154-5" title="5">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb154-6" title="6">                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-7" title="7">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),</a>
<a class="sourceLine" id="cb154-8" title="8">                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-9" title="9">                    <span class="co"># pie_index == &quot;b&quot;</span></a>
<a class="sourceLine" id="cb154-10" title="10">                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-11" title="11">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-12" title="12">                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">each =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-13" title="13">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-14" title="14">                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-15" title="15">                    <span class="co"># pie_index == &quot;c&quot;,</span></a>
<a class="sourceLine" id="cb154-16" title="16">                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb154-17" title="17">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-18" title="18">                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)), </a>
<a class="sourceLine" id="cb154-19" title="19">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-20" title="20">                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-21" title="21">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb154-22" title="22">                    )</a>
<a class="sourceLine" id="cb154-23" title="23">         )</a>
<a class="sourceLine" id="cb154-24" title="24">lines_<span class="dv">1</span> &lt;-</a>
<a class="sourceLine" id="cb154-25" title="25"><span class="st">  </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb154-26" title="26"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb154-27" title="27">                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-28" title="28">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-29" title="29">                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">each  =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-30" title="30">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-31" title="31">                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb154-32" title="32">                    )</a>
<a class="sourceLine" id="cb154-33" title="33">         )</a>
<a class="sourceLine" id="cb154-34" title="34">lines_<span class="dv">2</span> &lt;-</a>
<a class="sourceLine" id="cb154-35" title="35"><span class="st">  </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb154-36" title="36"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),</a>
<a class="sourceLine" id="cb154-37" title="37">                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-38" title="38">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span>),</a>
<a class="sourceLine" id="cb154-39" title="39">                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb154-40" title="40">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-41" title="41">                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb154-42" title="42">                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb154-43" title="43">                    )</a>
<a class="sourceLine" id="cb154-44" title="44">         )</a></code></pre></div>
<p>We’re finally ready to plot our Figure 2.4.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-2" title="2"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">8</span>), </a>
<a class="sourceLine" id="cb155-3" title="3">        <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-4" title="4"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb155-5" title="5">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend, </a>
<a class="sourceLine" id="cb155-6" title="6">        <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb155-7" title="7">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb155-8" title="8">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend, </a>
<a class="sourceLine" id="cb155-9" title="9">        <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb155-10" title="10">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill, </a>
<a class="sourceLine" id="cb155-11" title="11">    <span class="dt">size =</span> draw, <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb155-12" title="12">    <span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, </a>
<a class="sourceLine" id="cb155-13" title="13">    <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">3</span>, </a>
<a class="sourceLine" id="cb155-14" title="14">    <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, </a>
<a class="sourceLine" id="cb155-15" title="15">    <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb155-16" title="16">    <span class="dv">12</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb155-17" title="17">    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">3.5</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-18" title="18"><span class="st">    </span><span class="kw">coord_polar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb155-19" title="19">    <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-tibble">
<p>Müller, Kirill, and Hadley Wickham. 2020. <em>Tibble: Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2020. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tickling-the-ivories.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book-probabilistic-reasoning.pdf", "book-probabilistic-reasoning.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
