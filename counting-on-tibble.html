<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Counting on tibble | Probabilistic Reasoning</title>
  <meta name="description" content="We explore practical implementations of probabilistic reasoning applied to several domains, especially those in human organizations." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Counting on tibble | Probabilistic Reasoning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="We explore practical implementations of probabilistic reasoning applied to several domains, especially those in human organizations." />
  <meta name="github-repo" content="wgfoote/book-probabilistic-reasoning" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Counting on tibble | Probabilistic Reasoning" />
  <meta name="twitter:site" content="@wgfoote" />
  <meta name="twitter:description" content="We explore practical implementations of probabilistic reasoning applied to several domains, especially those in human organizations." />
  

<meta name="author" content="William G. Foote" />


<meta name="date" content="2020-10-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tickling-the-ivories.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Probabilistic Reasoning: A Primer</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this-book"><i class="fa fa-check"></i>Why this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#premises"><i class="fa fa-check"></i>Premises</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dont-we-know-everything-we-need-to-know"><i class="fa fa-check"></i>Don’t we know everything we need to know?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-we-desire"><i class="fa fa-check"></i>What we desire</a></li>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#frequentist-or-probabilistic"><i class="fa fa-check"></i><b>0.1</b> Frequentist or probabilistic?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-work-in-progress"><i class="fa fa-check"></i>A work in progress</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-background.html"><a href="part-i-background.html"><i class="fa fa-check"></i>Part I. Background</a></li>
<li class="chapter" data-level="1" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html"><i class="fa fa-check"></i><b>1</b> Plausibility, Probability and Information</a><ul>
<li class="chapter" data-level="1.1" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#some-surprise"><i class="fa fa-check"></i><b>1.1</b> Some Surprise</a></li>
<li class="chapter" data-level="1.2" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#informative"><i class="fa fa-check"></i><b>1.2</b> Informative?</a></li>
<li class="chapter" data-level="1.3" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#we-have-a-proposition-for-you"><i class="fa fa-check"></i><b>1.3</b> We have a proposition for you</a></li>
<li class="chapter" data-level="1.4" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#the-power-of-plausible-thinking"><i class="fa fa-check"></i><b>1.4</b> The power of plausible thinking</a></li>
<li class="chapter" data-level="1.5" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#how-many-ways"><i class="fa fa-check"></i><b>1.5</b> How many ways?</a></li>
<li class="chapter" data-level="1.6" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#how-informative"><i class="fa fa-check"></i><b>1.6</b> How informative?</a></li>
<li class="chapter" data-level="1.7" data-path="plausibility-probability-and-information.html"><a href="plausibility-probability-and-information.html#nota-bene"><i class="fa fa-check"></i><b>1.7</b> Nota Bene</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html"><i class="fa fa-check"></i><b>2</b> Probability for Real People</a><ul>
<li class="chapter" data-level="2.1" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#can-we-rationally-reason"><i class="fa fa-check"></i><b>2.1</b> Can we rationally reason?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#priors-what-we-think-can-happen"><i class="fa fa-check"></i><b>2.1.1</b> Priors: what we think can happen</a></li>
<li class="chapter" data-level="2.1.2" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#likelihoods-thinking-about-the-data"><i class="fa fa-check"></i><b>2.1.2</b> Likelihoods: thinking about the data</a></li>
<li class="chapter" data-level="2.1.3" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#altogether-now"><i class="fa fa-check"></i><b>2.1.3</b> Altogether now</a></li>
<li class="chapter" data-level="2.1.4" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#updating-beliefs"><i class="fa fa-check"></i><b>2.1.4</b> Updating beliefs</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-for-real-people.html"><a href="probability-for-real-people.html#whats-next"><i class="fa fa-check"></i><b>2.2</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-using-r.html"><a href="part-ii-using-r.html"><i class="fa fa-check"></i>Part II. Using R</a></li>
<li class="chapter" data-level="3" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html"><i class="fa fa-check"></i><b>3</b> Warming up to R and more</a><ul>
<li class="chapter" data-level="3.1" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#what-is-r"><i class="fa fa-check"></i><b>3.2</b> What is <code>R</code>?</a></li>
<li class="chapter" data-level="3.3" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#r-for-analytics"><i class="fa fa-check"></i><b>3.3</b> <code>R</code> for analytics</a></li>
<li class="chapter" data-level="3.4" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#hot-and-cold-running-resources"><i class="fa fa-check"></i><b>3.4</b> Hot and cold running resources</a></li>
<li class="chapter" data-level="3.5" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#gettingR"><i class="fa fa-check"></i><b>3.5</b> Installing R</a><ul>
<li class="chapter" data-level="3.5.1" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#installing-r-on-a-windows-computer"><i class="fa fa-check"></i><b>3.5.1</b> Installing R on a Windows computer</a></li>
<li class="chapter" data-level="3.5.2" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#installing-r-on-a-mac"><i class="fa fa-check"></i><b>3.5.2</b> Installing R on a Mac</a></li>
<li class="chapter" data-level="3.5.3" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#installing-r-on-a-linux-computer"><i class="fa fa-check"></i><b>3.5.3</b> Installing R on a Linux computer</a></li>
<li class="chapter" data-level="3.5.4" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#installingrstudio"><i class="fa fa-check"></i><b>3.5.4</b> Downloading and installing RStudio</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#first-day-at-school"><i class="fa fa-check"></i><b>3.6</b> First day at school</a><ul>
<li class="chapter" data-level="3.6.1" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#install-r-markdown"><i class="fa fa-check"></i><b>3.6.1</b> Install <code>R Markdown</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#install-latex"><i class="fa fa-check"></i><b>3.7</b> Install LaTex</a><ul>
<li class="chapter" data-level="3.7.1" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#our-first-file"><i class="fa fa-check"></i><b>3.7.1</b> Our first file</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#some-fun-with-stan"><i class="fa fa-check"></i><b>3.8</b> Some fun with Stan</a></li>
<li class="chapter" data-level="3.9" data-path="warming-up-to-r-and-more.html"><a href="warming-up-to-r-and-more.html#github"><i class="fa fa-check"></i><b>3.9</b> Github</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html"><i class="fa fa-check"></i><b>4</b> Tickling the Ivories</a><ul>
<li class="chapter" data-level="4.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#start-to-tickle"><i class="fa fa-check"></i><b>4.1</b> Start to tickle</a></li>
<li class="chapter" data-level="4.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#try-this-exercise"><i class="fa fa-check"></i><b>4.2</b> Try this exercise</a></li>
<li class="chapter" data-level="4.3" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#building-some-character"><i class="fa fa-check"></i><b>4.3</b> Building Some Character</a></li>
<li class="chapter" data-level="4.4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#the-plot-thickens"><i class="fa fa-check"></i><b>4.4</b> The plot thickens</a><ul>
<li class="chapter" data-level="4.4.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#try-this-example"><i class="fa fa-check"></i><b>4.4.1</b> Try this example</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#arrays-and-you"><i class="fa fa-check"></i><b>4.5</b> Arrays and You</a><ul>
<li class="chapter" data-level="4.5.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#try-this-exercise-1"><i class="fa fa-check"></i><b>4.5.1</b> Try this exercise</a></li>
<li class="chapter" data-level="4.5.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#more-about-residuals"><i class="fa fa-check"></i><b>4.5.2</b> More about residuals</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#more-array-work"><i class="fa fa-check"></i><b>4.6</b> More Array Work</a></li>
<li class="chapter" data-level="4.7" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#summary"><i class="fa fa-check"></i><b>4.7</b> Summary</a></li>
<li class="chapter" data-level="4.8" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#further-reading"><i class="fa fa-check"></i><b>4.8</b> Further Reading</a></li>
<li class="chapter" data-level="4.9" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#practice-sets"><i class="fa fa-check"></i><b>4.9</b> Practice Sets</a><ul>
<li class="chapter" data-level="4.9.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#purpose-process-product"><i class="fa fa-check"></i><b>4.9.1</b> Purpose, Process, Product</a></li>
<li class="chapter" data-level="4.9.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#r-markdown-set-up"><i class="fa fa-check"></i><b>4.9.2</b> <code>R Markdown</code> set up</a></li>
<li class="chapter" data-level="4.9.3" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#mutual-fund-simulation"><i class="fa fa-check"></i><b>4.9.3</b> Mutual Fund simulation</a></li>
<li class="chapter" data-level="4.9.4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#healthcare-provider-admission-rates"><i class="fa fa-check"></i><b>4.9.4</b> Healthcare provider admission rates</a></li>
<li class="chapter" data-level="4.9.5" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#practice-set-debrief"><i class="fa fa-check"></i><b>4.9.5</b> Practice Set Debrief</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#project-captive-financing"><i class="fa fa-check"></i><b>4.10</b> Project: Captive Financing</a><ul>
<li class="chapter" data-level="4.10.1" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#purpose"><i class="fa fa-check"></i><b>4.10.1</b> Purpose</a></li>
<li class="chapter" data-level="4.10.2" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#problem-2"><i class="fa fa-check"></i><b>4.10.2</b> Problem</a></li>
<li class="chapter" data-level="4.10.3" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#data"><i class="fa fa-check"></i><b>4.10.3</b> Data</a></li>
<li class="chapter" data-level="4.10.4" data-path="tickling-the-ivories.html"><a href="tickling-the-ivories.html#work-flow"><i class="fa fa-check"></i><b>4.10.4</b> Work Flow</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="counting-on-tibble.html"><a href="counting-on-tibble.html"><i class="fa fa-check"></i><b>5</b> Counting on tibble</a><ul>
<li class="chapter" data-level="5.1" data-path="counting-on-tibble.html"><a href="counting-on-tibble.html#counting-the-ways"><i class="fa fa-check"></i><b>5.1</b> Counting the ways</a></li>
<li class="chapter" data-level="5.2" data-path="counting-on-tibble.html"><a href="counting-on-tibble.html#having-all-of-our-marbles"><i class="fa fa-check"></i><b>5.2</b> Having all of our marbles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probabilistic Reasoning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="counting-on-tibble" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Counting on tibble</h1>
<div id="counting-the-ways" class="section level2">
<h2><span class="header-section-number">5.1</span> Counting the ways</h2>
<p>Instead of the base R wrangling we began to use in the previous chapter, we’ll make extensive use of the many packages from the <a href="https://www.tidyverse.org"><strong>tidyverse</strong></a> for data wrangling and plotting. Much of the R programming is a direct fork (I guess as in sticking a fork into a plate of food and putting in our mouth) from <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/02.Rmd">Solomon Kurz’s</a> recasting of <span class="citation">McElreath (<a href="#ref-McElreath_2020" role="doc-biblioref">2020</a>)</span>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>The <strong>tidyverse</strong>-style syntax pipes <code>%&gt;%</code> nouns (data) into verbs (functions). In RStudio we can use the <code>shift-ctrl-m</code> key combination to make the pipe with space formatting before and after. A good practice is to use piping as if they are analytical layers and thus press enter after each <code>%&gt;%</code>to create a new row of row. The beauty of this approach is that we can follow the workflow as each piping literally creates new data from analytical step to analytical step in the workflow. Read chapter 5 of Grolemund and Wickham’s <em>R for Data Science</em> available online in <a href="https://r4ds.had.co.nz/transform.html#combining-multiple-operations-with-the-pipe">Section 5.6.1</a>.</p>
<p>We will extensively use the <code>ggplot2</code> <span class="citation">(Wickham et al. <a href="#ref-R-ggplot2" role="doc-biblioref">2020</a>; Wickham <a href="#ref-wickhamGgplot2ElegantGraphics2016" role="doc-biblioref">2016</a>)</span> system in the tidyverse. The <code>gg</code> stands for the <em><strong>grammar of graphics</strong></em>. In this framework, similar to the way Adobe Photoshop and other image processors work, we layer graphical elements onto a blank canvas. These elements start with a data frame, here a <code>tibble</code>. From the tibble axes on a canvas along with groupings of data using factors that are categorical variables in the tibble. We then put geometrical objects on top of this growing canvas. Objects include lines, points, text all with size, shape, and color, among other attributes. We can also make graphics interactive using the <code>plotly</code> package with tools such as brushing, zooming, and visually driven queries. The <a href="https://plotly.com/">plotly site</a> has much more information and many gallery examples of which we might avail ourselves. As interesting, and where plotly is going is it calls itself <em>the front-end of ML [machine learning] and data science.</em>.</p>
<p><a href="https://tibble.tidyverse.org">Tibbles</a> <span class="citation">(Müller and Wickham <a href="#ref-R-tibble" role="doc-biblioref">2020</a>)</span> are the backbone of the management of the data we use in all of the functional workings of our model. First of all, a tibble is a data frame and has the two dimensions of any matrix or table, rows and columns. So, whenever we talk about data frames, we’re usually talking about tibbles. For more on the topic, check out <a href="https://r4ds.had.co.nz/tibbles.html"><em>R4SD</em>, Chapter 10</a>.</p>
<p>It is often best to learn of tibbles by doing. Doing what? Why, it is piping data from a raw tibble to aggregations of the data, transformations of the raw data and aggregations. Here is a very simple example in the tidyverse that makes use of the <code>dplyr</code> package.</p>
<p>Let’s make some toy data to play with. We generate 100 variates normally distributed with mean 10 and standard deviation 5. We then transform this series into another and display the first 10 rows. To reproduce results we set the random seed.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb131-3" title="3">n_sim &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb131-4" title="4">x &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(n_sim, <span class="dv">10</span>, <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb131-5" title="5">y &lt;-<span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>x</a>
<a class="sourceLine" id="cb131-6" title="6">xy_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">y =</span> y, <span class="dt">x =</span> x)</a>
<a class="sourceLine" id="cb131-7" title="7">xy_tbl</a></code></pre></div>
<pre><code>## # A tibble: 100 x 2
##        y     x
##    &lt;dbl&gt; &lt;dbl&gt;
##  1 11.4  16.9 
##  2  6.59  7.18
##  3  8.91 11.8 
##  4  9.58 13.2 
##  5  9.01 12.0 
##  6  7.73  9.47
##  7 11.8  17.6 
##  8  7.76  9.53
##  9 13.0  20.1 
## 10  7.84  9.69
## # ... with 90 more rows</code></pre>
<p>With this tibble we can transform the variables by adding more through a pipe to the <code>mutate()</code> verb and assign the results to another tibble object.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">xy_tbl &lt;-<span class="st"> </span>xy_tbl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">log_y =</span> <span class="kw">log</span>(y), </a>
<a class="sourceLine" id="cb133-2" title="2">    <span class="dt">log_x =</span> <span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb133-3" title="3">xy_tbl</a></code></pre></div>
<pre><code>## # A tibble: 100 x 4
##        y     x log_y log_x
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 11.4  16.9   2.44  2.82
##  2  6.59  7.18  1.89  1.97
##  3  8.91 11.8   2.19  2.47
##  4  9.58 13.2   2.26  2.58
##  5  9.01 12.0   2.20  2.49
##  6  7.73  9.47  2.05  2.25
##  7 11.8  17.6   2.47  2.87
##  8  7.76  9.53  2.05  2.25
##  9 13.0  20.1   2.57  3.00
## 10  7.84  9.69  2.06  2.27
## # ... with 90 more rows</code></pre>
<p>Of course, in this code we overwrote the first version of the <code>xy_tbl</code> tibble.</p>
<p>Next we aggregate this transformed tibble into a custom summary of the data.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">4</span>, <span class="dt">scipen =</span> <span class="dv">99999</span>)</a>
<a class="sourceLine" id="cb135-2" title="2">xy_summary &lt;-<span class="st"> </span>xy_tbl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;variable&quot;</span>, </a>
<a class="sourceLine" id="cb135-3" title="3">    <span class="dt">value =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb135-4" title="4"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">min =</span> <span class="kw">min</span>(value), <span class="dt">pct_5 =</span> <span class="kw">quantile</span>(value, </a>
<a class="sourceLine" id="cb135-5" title="5">        <span class="fl">0.05</span>), <span class="dt">pct_50 =</span> <span class="kw">quantile</span>(value, </a>
<a class="sourceLine" id="cb135-6" title="6">        <span class="fl">0.5</span>), <span class="dt">pct_95 =</span> <span class="kw">quantile</span>(value, </a>
<a class="sourceLine" id="cb135-7" title="7">        <span class="fl">0.95</span>), <span class="dt">max =</span> <span class="kw">max</span>(value))</a>
<a class="sourceLine" id="cb135-8" title="8">xy_summary</a></code></pre></div>
<pre><code>## # A tibble: 4 x 6
##   variable    min pct_5 pct_50 pct_95   max
##   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 log_x    0.0893 0.984   2.35   2.87  3.06
## 2 log_y    1.27   1.47    2.11   2.47  2.62
## 3 x        1.09   2.68   10.4   17.6  21.4 
## 4 y        3.55   4.34    8.22  11.8  13.7</code></pre>
<p>Lots of things are happing to us here.</p>
<ul>
<li><p><code>options</code> sets the rest of the calculations to 4 decimal places with sufficient penalties to avoid scientific notation.</p></li>
<li><p><code>gather()</code> puts the data into a long format, also known as a flat table.</p></li>
<li><p>This allows us to <code>group_by</code> the subsequent aggregations in <code>summarize()</code> by <code>variable</code>, the data key.</p></li>
<li><p>The transformed tibble has <code>summarized()</code>d each variable’s vital statistics in new tibble colums.</p></li>
</ul>
<p>The inverse of <code>gather()</code> is <code>arrange()</code> which awaits us in future work.</p>
<p>This is a great start to exploring our data. Gosh, we could even write a helper function to wrap all of this into an easy to use replacement for the base R <code>summary()</code> function. Again this lovely activity awaits us in future work.</p>
</div>
<div id="having-all-of-our-marbles" class="section level2">
<h2><span class="header-section-number">5.2</span> Having all of our marbles</h2>
<p>Let code the example in chapter 1. This includes red and blue voters. Let’s willingly suspend our disbelief and call them marbles in a bag. The bag is not transparent and those who draw a marble-voter from the bag are blind-folded. If they were draw a marble-voter from the bag they must return their find to the bag.</p>
<p>If we’re willing to code the marbles as 0 = <em><strong>red</strong></em> 1 = <em><strong>blue</strong></em>, we can arrange the hypothetical possibilities of combinations of blue and red marble-voters in a tibble <em>qua</em> bag as follows. Again this is data. Attributes like color and shapes will indeed follow, but at the visualization layer of the architecture of this discussion and coding exercise.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">p1 =</span> <span class="dv">0</span>, <span class="dt">p2 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb137-2" title="2">    <span class="dv">3</span>)), <span class="dt">p3 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb137-3" title="3">    <span class="dt">p4 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)), <span class="dt">p5 =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb137-4" title="4">d</a></code></pre></div>
<pre><code>## # A tibble: 4 x 5
##      p1    p2    p3    p4    p5
##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     0     1     1     1     1
## 2     0     0     1     1     1
## 3     0     0     0     1     1
## 4     0     0     0     0     1</code></pre>
<p>YATBL = <em>yet another tibble</em>, and they will not stop coming! In this one we use the <code>rep()</code> function to replicate first 1’s then down to 0’s once and then 3 times in <code>p2</code>. This creates a 4 row by 5 column array with upper 1’s and lower 0’s.</p>
<p>We will visualize this arrange in a transformation of this tibble. First we use <code>set_names()</code> to replace the <code>p1</code> to <code>p5</code> column names. With <code>mutate()</code> we create row names of the 4 conjectures labelled 1 to 4. The <code>pivot_longer()</code> creates a flat grid of</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">d &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-2" title="2"><span class="st">    </span><span class="kw">pivot_longer</span>(<span class="op">-</span>x, <span class="dt">names_to =</span> <span class="st">&quot;conjecture&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">value =</span> value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>())</a>
<a class="sourceLine" id="cb139-4" title="4">d</a></code></pre></div>
<pre><code>## # A tibble: 20 x 3
##        x conjecture value
##    &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;
##  1     1 1          0    
##  2     1 2          1    
##  3     1 3          1    
##  4     1 4          1    
##  5     1 5          1    
##  6     2 1          0    
##  7     2 2          0    
##  8     2 3          1    
##  9     2 4          1    
## 10     2 5          1    
## 11     3 1          0    
## 12     3 2          0    
## 13     3 3          0    
## 14     3 4          1    
## 15     3 5          1    
## 16     4 1          0    
## 17     4 2          0    
## 18     4 3          0    
## 19     4 4          0    
## 20     4 5          1</code></pre>
<p>we see the flat grid of for 1 there are each 1, then 2, then and so on to 4. Then this is stacked on four 2’s, on top of four 3’s, and four 4’s. This is the same kind of operation the <code>gather()</code> function performed in the previous section. We then add one for line to identify that the value column are not only the 1’s and 0’s from the tibble, but they are to be characters. This allows our plot to identify them as categories and thus fillable with colors.</p>
<p>With all of that we make the plot. The `<code>ggplot()</code> statement sets up the canvas with x and y axes and the value fill for each of the x by possibilities in the bag of marbles-voters. Laayered in are points with a particular <a href="http://www.cookbook-r.com/Graphs/Shapes_and_line_types/">shape</a> and size, fill colors, and scaling details. A <code>theme()</code> call removes the unnecessary (for our purpose) legend.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">p1 =</span> <span class="dv">0</span>, <span class="dt">p2 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb141-2" title="2">    <span class="dv">3</span>)), <span class="dt">p3 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb141-3" title="3">    <span class="dt">p4 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)), <span class="dt">p5 =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb141-4" title="4"><span class="co"># </span></a>
<a class="sourceLine" id="cb141-5" title="5">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb141-6" title="6"><span class="st">    </span><span class="kw">pivot_longer</span>(<span class="op">-</span>x, <span class="dt">names_to =</span> <span class="st">&quot;conjecture&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb141-7" title="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">value =</span> value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb141-8" title="8"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> conjecture, </a>
<a class="sourceLine" id="cb141-9" title="9">        <span class="dt">fill =</span> value)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </a>
<a class="sourceLine" id="cb141-10" title="10">    <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb141-11" title="11">    <span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb141-12" title="12">    <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>The <code>tidyr::pivot_longer()</code> function is an updated variant of <code>gather()</code>. Just like Excel pivot tables, <code>pivot_longer()</code> allows for very creative reshaping and aggregation of data. These articles, <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">here</a> and <a href="https://tidyr.tidyverse.org/articles/pivot.html">here</a> <span class="citation">(“Pivot Data from Wide to Long Pivot_longer” <a href="#ref-PivotDataWide2020" role="doc-biblioref">2020</a>; “Pivoting” <a href="#ref-Pivoting2020" role="doc-biblioref">2020</a>)</span>, provide more examples.</p>
<p>Here’s the basic structure of the conjectures per marble-voter draw.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1"><span class="kw">tibble</span>(<span class="dt">draw =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">marbles =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">possibilities =</span> marbles<span class="op">^</span>draw) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb142-2" title="2"><span class="st">    </span>knitr<span class="op">::</span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
draw
</th>
<th style="text-align:right;">
marbles
</th>
<th style="text-align:right;">
possibilities
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
16
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
64
</td>
</tr>
</tbody>
</table>
<p>We have a table and visual of the 5 conjedctures in hand. Now we make another flat (longer format again) tibble that will have 84 rows of all of the combinations of the three draws of blue, red, and blue in the example. At the first draw there are 4 marble-voters. At the second draw there are <span class="math inline">\(4^2 = 16\)</span> potential marble-voter draws. At the third draw each of these 16 has 4 marble-voters in the bag as possibilities or <span class="math inline">\(4^3=64\)</span>. These are positions on a tree with 4 nodes blossoming into 16 nodes, further growing into 64 nodes for a total of 84 nodes. We then linearly interpolate equally spaced nodes from node 1 to node 84.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">position &lt;-<span class="st"> </span><span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb143-2" title="2">    (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb143-3" title="3">position</a></code></pre></div>
<pre><code>##  [1] 1.0000 2.0000 3.0000 4.0000 0.2500 0.5000 0.7500 1.0000 1.2500 1.5000 1.7500 2.0000
## [13] 2.2500 2.5000 2.7500 3.0000 3.2500 3.5000 3.7500 4.0000 0.0625 0.1250 0.1875 0.2500
## [25] 0.3125 0.3750 0.4375 0.5000 0.5625 0.6250 0.6875 0.7500 0.8125 0.8750 0.9375 1.0000
## [37] 1.0625 1.1250 1.1875 1.2500 1.3125 1.3750 1.4375 1.5000 1.5625 1.6250 1.6875 1.7500
## [49] 1.8125 1.8750 1.9375 2.0000 2.0625 2.1250 2.1875 2.2500 2.3125 2.3750 2.4375 2.5000
## [61] 2.5625 2.6250 2.6875 2.7500 2.8125 2.8750 2.9375 3.0000 3.0625 3.1250 3.1875 3.2500
## [73] 3.3125 3.3750 3.4375 3.5000 3.5625 3.6250 3.6875 3.7500 3.8125 3.8750 3.9375 4.0000</code></pre>
<p>Not only that we should label each node level as draw 1, 2, and 3. For 84 nodes we have to match the first draw of 4 marble-voters, each of which again blossoms into 4 for a total of 16 potential marble-voters, and on to the third draw with 64 marble voters for a total of 84 again.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">draw &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, </a>
<a class="sourceLine" id="cb145-2" title="2">    <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb145-3" title="3">draw</a></code></pre></div>
<pre><code>##  [1] 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [44] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</code></pre>
<p>In a plot we will fill these categorically with blue and red. First we get the conjecture sequence of blue, followed by 3 red marbles in the bag. We remember that this is one of five conjectures.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">fill &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;r&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb147-2" title="2">    <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb147-3" title="3">fill</a></code></pre></div>
<pre><code>## [1] &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot;</code></pre>
<p>Now we mash these four marbles with the 84 draws and positions.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">fill &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;r&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb149-2" title="2">    <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb149-3" title="3"><span class="st">    </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb149-4" title="4">fill</a></code></pre></div>
<pre><code>##  [1] &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot;
## [22] &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot;
## [43] &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot;
## [64] &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot; &quot;b&quot; &quot;r&quot; &quot;r&quot; &quot;r&quot;</code></pre>
<p>All together we have this tibble. While this is quite a job to think through and carve out this hierarchical data tree we gain insight into how data is shaped and molded to our purposes.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">position =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb151-2" title="2">    (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)<span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>), <span class="dt">draw =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb151-3" title="3">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)), <span class="dt">fill =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, </a>
<a class="sourceLine" id="cb151-4" title="4">    <span class="st">&quot;r&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., </a>
<a class="sourceLine" id="cb151-5" title="5">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb151-6" title="6">d</a></code></pre></div>
<pre><code>## # A tibble: 84 x 3
##    position  draw fill 
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;
##  1     1        1 b    
##  2     2        1 r    
##  3     3        1 r    
##  4     4        1 r    
##  5     0.25     2 b    
##  6     0.5      2 r    
##  7     0.75     2 r    
##  8     1        2 r    
##  9     1.25     2 b    
## 10     1.5      2 r    
## # ... with 74 more rows</code></pre>
<p>We now have Solomon Kurz’s initial plot. We notice he put in 3 breaks in the otherwise continuous scale that is <code>position</code>.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw, </a>
<a class="sourceLine" id="cb153-2" title="2">    <span class="dt">fill =</span> fill)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </a>
<a class="sourceLine" id="cb153-3" title="3">    <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb153-4" title="4">    <span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-5" title="5"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-78-1.png" width="768" /></p>
<p>How do we draw lines from one draw (level in the hierarchy) to another? Again a tibble comes to our aid. Line segments in plots are simply beginning and ending x and y coordinates.The first of two tibbles will connect the positions from the first to the second draw. The second will connect the 16 second draw positions to the 64 third draw positions. The y coordinates are easy. The x coordinates are a little more daunting. But we have already computed these before in making the tibble positions. We are sure to notice the <code>each = 4</code> detail for the x coordinates as the nodes fan out from draw to draw.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="co"># these will connect the dots from</span></a>
<a class="sourceLine" id="cb154-2" title="2"><span class="co"># the first and second draws</span></a>
<a class="sourceLine" id="cb154-3" title="3">lines_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb154-4" title="4">    <span class="dt">xend =</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>), <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">yend =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb154-5" title="5">lines_<span class="dv">1</span></a></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1  0.25     1     2
##  2     1  0.5      1     2
##  3     1  0.75     1     2
##  4     1  1        1     2
##  5     2  1.25     1     2
##  6     2  1.5      1     2
##  7     2  1.75     1     2
##  8     2  2        1     2
##  9     3  2.25     1     2
## 10     3  2.5      1     2
## 11     3  2.75     1     2
## 12     3  3        1     2
## 13     4  3.25     1     2
## 14     4  3.5      1     2
## 15     4  3.75     1     2
## 16     4  4        1     2</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="co"># these will connect the dots from</span></a>
<a class="sourceLine" id="cb156-2" title="2"><span class="co"># the second and third draws</span></a>
<a class="sourceLine" id="cb156-3" title="3">lines_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rep</span>(((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>), </a>
<a class="sourceLine" id="cb156-4" title="4">    <span class="dt">each =</span> <span class="dv">4</span>), <span class="dt">xend =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">2</span>), </a>
<a class="sourceLine" id="cb156-5" title="5">    <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">yend =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb156-6" title="6">lines_<span class="dv">2</span></a></code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.25 0.0625     2     3
##  2  0.25 0.125      2     3
##  3  0.25 0.188      2     3
##  4  0.25 0.25       2     3
##  5  0.5  0.312      2     3
##  6  0.5  0.375      2     3
##  7  0.5  0.438      2     3
##  8  0.5  0.5        2     3
##  9  0.75 0.562      2     3
## 10  0.75 0.625      2     3
## # ... with 54 more rows</code></pre>
<p>We now use the <code>lines_1</code> and <code>lines_2</code> data in the plot with two <code>geom_segment()</code> functions layered into the initial plot.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb158-2" title="2"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb158-3" title="3">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb158-4" title="4">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb158-5" title="5">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb158-6" title="6">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill), </a>
<a class="sourceLine" id="cb158-7" title="7">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb158-8" title="8">    <span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb158-9" title="9"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-80-1.png" width="768" /></p>
<p>We generated the values for <code>position</code> (i.e., the <span class="math inline">\(x\)</span>-axis) al right justified to the position number. To center the nodes for the first draw we simply will subtract 0.5 from each node. In a slightly trickier move, noting there are four marble-voter possibilities in this conjecture we will subtract <span class="math inline">\(0.50/4=0.125\)</span> for draw 2, and <span class="math inline">\((0.05/4)/4=0.125/4=0.03125\)</span> for draw 3. The <code>ifelse()</code> function will allow us to control the three conditions across the positions. If anything else, this is great control practice especially with piping. We should notice the use of the <span class="math inline">\(4^0=1,\,4^1=4,\,4^2=16\)</span> sequence.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">d &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">denominator =</span> <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span></a>
<a class="sourceLine" id="cb159-2" title="2"><span class="st">    </span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span>, </a>
<a class="sourceLine" id="cb159-3" title="3">    <span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">position =</span> position <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb159-4" title="4"><span class="st">    </span>denominator)</a></code></pre></div>
<p>The same logic will work for <code>lines_1</code> and <code>lines_2</code>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">lines_<span class="dv">1</span> &lt;-<span class="st"> </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> x <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-2" title="2"><span class="st">    </span><span class="fl">0.5</span>, <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb160-3" title="3">lines_<span class="dv">2</span> &lt;-<span class="st"> </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x =</span> x <span class="op">-</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-4" title="4"><span class="st">    </span><span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">/</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb160-5" title="5">lines_<span class="dv">1</span></a></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   0.5 0.125     1     2
##  2   0.5 0.375     1     2
##  3   0.5 0.625     1     2
##  4   0.5 0.875     1     2
##  5   1.5 1.12      1     2
##  6   1.5 1.38      1     2
##  7   1.5 1.62      1     2
##  8   1.5 1.88      1     2
##  9   2.5 2.12      1     2
## 10   2.5 2.38      1     2
## 11   2.5 2.62      1     2
## 12   2.5 2.88      1     2
## 13   3.5 3.12      1     2
## 14   3.5 3.38      1     2
## 15   3.5 3.62      1     2
## 16   3.5 3.88      1     2</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1">lines_<span class="dv">2</span></a></code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.125 0.0312     2     3
##  2 0.125 0.0938     2     3
##  3 0.125 0.156      2     3
##  4 0.125 0.219      2     3
##  5 0.375 0.281      2     3
##  6 0.375 0.344      2     3
##  7 0.375 0.406      2     3
##  8 0.375 0.469      2     3
##  9 0.625 0.531      2     3
## 10 0.625 0.594      2     3
## # ... with 54 more rows</code></pre>
<p>Now the plot looks centered and more like a drafting dream come true.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb164-2" title="2"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb164-3" title="3">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb164-4" title="4">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb164-5" title="5">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb164-6" title="6">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill), </a>
<a class="sourceLine" id="cb164-7" title="7">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb164-8" title="8">    <span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb164-9" title="9"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-81-1.png" width="768" /></p>
<p>Last and not the least visually, let’s wrap the x-axis about a circle by transforming from a rectangular to a <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/coord">polar coordinate system</a> with the <code>coord_polar()</code> layer.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-2" title="2"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb165-3" title="3">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb165-4" title="4">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb165-5" title="5">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend), </a>
<a class="sourceLine" id="cb165-6" title="6">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill), </a>
<a class="sourceLine" id="cb165-7" title="7">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb165-8" title="8">    <span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb165-9" title="9">    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-10" title="10"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, </a>
<a class="sourceLine" id="cb165-11" title="11">        <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_polar</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb165-12" title="12"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-82-1.png" width="384" /></p>
<p>We have to recall that the 1 blue and three red in the middle of this mandela is but one conjecture. There are 4 others, only two of which are non-trivial. The whole point of this execise is the identify by brute force enumeration the only three choices that allow the data to be consistent with the conjecture. To illustrate this Kurz adds an index called <code>remain</code> to indicate only those logically consistent paths after each choice for nodes and lines (edges) of this graph. The <code>remain</code> indicator is 1 if the draw (data) is logically consistent with the conjecture (hypothesis) and 0 if not. We will print out <code>d</code> to illustrate.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1">lines_<span class="dv">1</span> &lt;-<span class="st"> </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb166-2" title="2">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb166-3" title="3"><span class="st">    </span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb166-4" title="4">lines_<span class="dv">2</span> &lt;-<span class="st"> </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb166-5" title="5">    <span class="dt">times =</span> <span class="dv">4</span>), <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb166-6" title="6">    <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>), <span class="kw">rep</span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb166-7" title="7">    <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb166-8" title="8">d &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb166-9" title="9">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)), <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb166-10" title="10">    <span class="dv">3</span>)), <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>), <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, </a>
<a class="sourceLine" id="cb166-11" title="11">    <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb166-12" title="12">    <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb166-13" title="13">d</a></code></pre></div>
<pre><code>## # A tibble: 84 x 5
##    position  draw fill  denominator remain
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;
##  1    0.5       1 b           0.5        1
##  2    1.5       1 r           0.5        0
##  3    2.5       1 r           0.5        0
##  4    3.5       1 r           0.5        0
##  5    0.125     2 b           0.125      0
##  6    0.375     2 r           0.125      1
##  7    0.625     2 r           0.125      1
##  8    0.875     2 r           0.125      1
##  9    1.12      2 b           0.125      0
## 10    1.38      2 r           0.125      0
## # ... with 74 more rows</code></pre>
<p>And now Kurz’s piece de resistance.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb168-2" title="2"><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb168-3" title="3">        <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend, </a>
<a class="sourceLine" id="cb168-4" title="4">        <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb168-5" title="5">        <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>, </a>
<a class="sourceLine" id="cb168-6" title="6">    <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend, <span class="dt">y =</span> y, <span class="dt">yend =</span> yend, </a>
<a class="sourceLine" id="cb168-7" title="7">        <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb168-8" title="8">    <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill, </a>
<a class="sourceLine" id="cb168-9" title="9">    <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()), </a>
<a class="sourceLine" id="cb168-10" title="10">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="co"># it&#39;s the alpha parameter that makes</span></a>
<a class="sourceLine" id="cb168-11" title="11"><span class="co"># elements semitransparent</span></a>
<a class="sourceLine" id="cb168-12" title="12"><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb168-13" title="13">    <span class="st">&quot;red&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, </a>
<a class="sourceLine" id="cb168-14" title="14">    <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </a>
<a class="sourceLine" id="cb168-15" title="15">    <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb168-16" title="16">    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb168-17" title="17"><span class="st">    </span><span class="kw">coord_polar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb168-18" title="18">    <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="book-probabilistic-reasoning_files/figure-html/unnamed-chunk-84-1.png" width="384" /></p>
<p>The <code>alpha</code> attribute in the <code>geom_point()</code> governs the opacity of each filled circle (<code>shape = 21</code>). When <code>remain</code> as a categorical variable (<code>%&gt;% as.character()</code>) is <code>1</code> the default 100% opacity is rendered. Otherwise a lesser opacity will render and thus we see the lighter elements.</p>
<p>All in all this exercise allows us to stretch our data creation, reshaping, and transformation muscles. It also shows the effort needed to create compelling visualizations of the data for consumption by decision makers.</p>
<p>A useful practice exercise is to use this model to build the visualizations of the other two conjectures.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-McElreath_2020">
<p>McElreath, R. 2020. <em>Statistical Rethinking: A Bayesian Course with Examples in R and Stan, 2nd Ed.</em></p>
</div>
<div id="ref-R-tibble">
<p>Müller, Kirill, and Hadley Wickham. 2020. <em>tibble: Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.</p>
</div>
<div id="ref-PivotDataWide2020">
<p>“Pivot Data from Wide to Long Pivot_longer.” 2020. <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">https://tidyr.tidyverse.org/reference/pivot_longer.html</a>.</p>
</div>
<div id="ref-Pivoting2020">
<p>“Pivoting.” 2020. <a href="https://tidyr.tidyverse.org/articles/pivot.html">https://tidyr.tidyverse.org/articles/pivot.html</a>.</p>
</div>
<div id="ref-wickhamGgplot2ElegantGraphics2016">
<p>Wickham, Hadley. 2016. <em>ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, and Dewey Dunnington. 2020. <em>ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tickling-the-ivories.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book-probabilistic-reasoning.pdf", "book-probabilistic-reasoning.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
